!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("angular")):"function"==typeof define&&define.amd?define(["angular"],e):e((t=t||self).angular)}(this,function(a){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a;function o(t){return e.call(t).slice(8,-1)}function v(t){return"object"==typeof t?null!==t:"function"==typeof t}function u(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function b(t){return Object(u(t))}function h(t){return isNaN(t=+t)?0:(0<t?c:r)(t)}function w(t){return 0<t?l(h(t),9007199254740991):0}function i(t,e){if(!v(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!v(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!v(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!v(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}function g(t){try{return!!t()}catch(t){return!0}}function s(t){return k?y.createElement(t):{}}function d(t){if(!v(t))throw TypeError(String(t)+" is not an object");return t}function m(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function p(t,e,r){var n=i(e);n in t?O.f(t,n,m(0,r)):t[n]=r}var e={}.toString,n=Array.isArray||function(t){return"Array"==o(t)},r=Math.ceil,c=Math.floor,l=Math.min,f=!g(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),_="object"==typeof window&&window&&window.Math==Math?window:"object"==typeof self&&self&&self.Math==Math?self:Function("return this")(),y=_.document,k=v(y)&&v(y.createElement),j=!f&&!g(function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}),P=Object.defineProperty,O={f:f?P:function(t,e,r){if(d(t),e=i(e,!0),d(r),j)try{return P(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function x(t,e){return t(e={exports:{}},e.exports),e.exports}function S(e,r){try{B(_,e,r)}catch(t){_[e]=r}return r}function A(t){return"Symbol(".concat(void 0===t?"":t,")_",(++G+H).toString(36))}function M(t){return $[t]||($[t]=U&&W[t]||(U?W:A)("Symbol."+t))}function C(t,e){var r;return n(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!n(r.prototype)?v(r)&&null===(r=r[V])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}function I(e){return!g(function(){var t=[];return(t.constructor={})[q]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function D(t){return Z(u(t))}function z(t,e){return X.call(t,e)}function T(t){return it[t]||(it[t]=A(t))}var N,F,L,B=f?function(t,e,r){return O.f(t,e,m(1,r))}:function(t,e,r){return t[e]=r,t},R=x(function(t){var e="__core-js_shared__",r=_[e]||S(e,{});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.0.1",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),G=0,H=Math.random(),U=!g(function(){return!String(Symbol())}),$=R("wks"),W=_.Symbol,V=M("species"),q=M("species"),J={}.propertyIsEnumerable,K=Object.getOwnPropertyDescriptor,Q={f:K&&!J.call({1:2},1)?function(t){var e=K(this,t);return!!e&&e.enumerable}:J},Y="".split,Z=g(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?Y.call(t,""):Object(t)}:Object,X={}.hasOwnProperty,tt=Object.getOwnPropertyDescriptor,et={f:f?tt:function(t,e){if(t=D(t),e=i(e,!0),j)try{return tt(t,e)}catch(t){}if(z(t,e))return m(!Q.f.call(t,e),t[e])}},rt=R("native-function-to-string",Function.toString),nt=_.WeakMap,ot="function"==typeof nt&&/native code/.test(rt.call(nt)),it=R("keys"),at={},st=_.WeakMap;if(ot){var ut=new st,ct=ut.get,lt=ut.has,ft=ut.set;N=function(t,e){return ft.call(ut,t,e),e},F=function(t){return ct.call(ut,t)||{}},L=function(t){return lt.call(ut,t)}}else{var ht=T("state");at[ht]=!0,N=function(t,e){return B(t,ht,e),e},F=function(t){return z(t,ht)?t[ht]:{}},L=function(t){return z(t,ht)}}function dt(t,e){var r=h(t);return r<0?kt(r+e,0):jt(r,e)}function pt(s){return function(t,e,r){var n,o=D(t),i=w(o.length),a=dt(r,i);if(s&&e!=e){for(;a<i;)if((n=o[a++])!=n)return!0}else for(;a<i;a++)if((s||a in o)&&o[a]===e)return s||a||0;return!s&&-1}}function yt(t,e){var r,n=D(t),o=0,i=[];for(r in n)!z(at,r)&&z(n,r)&&i.push(r);for(;e.length>o;)z(n,r=e[o++])&&(~Pt(i,r)||i.push(r));return i}function vt(t,e){for(var r=Mt(e),n=O.f,o=et.f,i=0;i<r.length;i++){var a=r[i];z(t,a)||n(t,a,o(e,a))}}function gt(t,e){var r=Dt[It(t)];return r==Tt||r!=zt&&("function"==typeof e?g(e):!!e)}function mt(t,e){var r,n,o,i,a,s=t.target,u=t.global,c=t.stat;if(r=u?_:c?_[s]||S(s,{}):(_[s]||{}).prototype)for(n in e){if(i=e[n],o=t.noTargetGet?(a=Ft(r,n))&&a.value:r[n],!Nt(u?n:s+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;vt(i,o)}(t.sham||o&&o.sham)&&B(i,"sham",!0),_t(r,n,i,t)}}function bt(t){if(!v(t))return!1;var e=t[Lt];return void 0!==e?!!e:n(t)}var wt={set:N,get:F,has:L,enforce:function(t){return L(t)?F(t):N(t,{})},getterFor:function(r){return function(t){var e;if(!v(t)||(e=F(t)).type!==r)throw TypeError("Incompatible receiver, "+r+" required");return e}}},_t=x(function(t){var e=wt.get,s=wt.enforce,u=String(rt).split("toString");R("inspectSource",function(t){return rt.call(t)}),(t.exports=function(t,e,r,n){var o=!!n&&!!n.unsafe,i=!!n&&!!n.enumerable,a=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof e||z(r,"name")||B(r,"name",e),s(r).source=u.join("string"==typeof e?e:"")),t!==_?(o?!a&&t[e]&&(i=!0):delete t[e],i?t[e]=r:B(t,e,r)):i?t[e]=r:S(e,r)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||rt.call(this)})}),kt=Math.max,jt=Math.min,Pt=pt(!1),Ot=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Et=Ot.concat("length","prototype"),xt={f:Object.getOwnPropertyNames||function(t){return yt(t,Et)}},St={f:Object.getOwnPropertySymbols},At=_.Reflect,Mt=At&&At.ownKeys||function(t){var e=xt.f(d(t)),r=St.f;return r?e.concat(r(t)):e},Ct=/#|\.prototype\./,It=gt.normalize=function(t){return String(t).replace(Ct,".").toLowerCase()},Dt=gt.data={},zt=gt.NATIVE="N",Tt=gt.POLYFILL="P",Nt=gt,Ft=et.f,Lt=M("isConcatSpreadable"),Bt=9007199254740991,Rt="Maximum allowed index exceeded",Gt=!g(function(){var t=[];return t[Lt]=!1,t.concat()[0]!==t}),Ht=I("concat");mt({target:"Array",proto:!0,forced:!Gt||!Ht},{concat:function(t){var e,r,n,o,i,a=b(this),s=C(a,0),u=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?a:arguments[e],bt(i)){if(o=w(i.length),Bt<u+o)throw TypeError(Rt);for(r=0;r<o;r++,u++)r in i&&p(s,u,i[r])}else{if(Bt<=u)throw TypeError(Rt);p(s,u++,i)}return s.length=u,s}});function Ut(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}function $t(n,o,t){if(Ut(n),void 0===o)return n;switch(t){case 0:return function(){return n.call(o)};case 1:return function(t){return n.call(o,t)};case 2:return function(t,e){return n.call(o,t,e)};case 3:return function(t,e,r){return n.call(o,t,e,r)}}return function(){return n.apply(o,arguments)}}function Wt(f,t){var h=1==f,d=2==f,p=3==f,y=4==f,v=6==f,g=5==f||v,m=t||C;return function(t,e,r){for(var n,o,i=b(t),a=Z(i),s=$t(e,r,3),u=w(a.length),c=0,l=h?m(t,u):d?m(t,0):void 0;c<u;c++)if((g||c in a)&&(o=s(n=a[c],c,i),f))if(h)l[c]=o;else if(o)switch(f){case 3:return!0;case 5:return n;case 6:return c;case 2:l.push(n)}else if(y)return!1;return v?-1:p||y?y:l}}function Vt(t,e){var r=[][t];return!r||!g(function(){r.call(null,e||function(){throw 1},1)})}var qt=Wt(4),Jt=Vt("every");mt({target:"Array",proto:!0,forced:Jt},{every:function(t){return qt(this,t,arguments[1])}});var Kt=Wt(2),Qt=I("filter");mt({target:"Array",proto:!0,forced:!Qt},{filter:function(t){return Kt(this,t,arguments[1])}});var Yt=[].forEach,Zt=Wt(0),Xt=Vt("forEach")?function(t){return Zt(this,t,arguments[1])}:Yt;mt({target:"Array",proto:!0,forced:[].forEach!=Xt},{forEach:Xt});var te=pt(!1),ee=[].indexOf,re=!!ee&&1/[1].indexOf(1,-0)<0,ne=Vt("indexOf");mt({target:"Array",proto:!0,forced:re||ne},{indexOf:function(t){return re?ee.apply(this,arguments)||0:te(this,t,arguments[1])}}),mt({target:"Array",stat:!0},{isArray:n});function oe(){}var ie=Object.keys||function(t){return yt(t,Ot)},ae=f?Object.defineProperties:function(t,e){d(t);for(var r,n=ie(e),o=n.length,i=0;i<o;)O.f(t,r=n[i++],e[r]);return t},se=_.document,ue=se&&se.documentElement,ce=T("IE_PROTO"),le="prototype",fe=function(){var t,e=s("iframe"),r=Ot.length,n="script";for(e.style.display="none",ue.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object</"+n+">"),t.close(),fe=t.F;r--;)delete fe[le][Ot[r]];return fe()},he=Object.create||function(t,e){var r;return null!==t?(oe[le]=d(t),r=new oe,oe[le]=null,r[ce]=t):r=fe(),void 0===e?r:ae(r,e)};at[ce]=!0;var de=M("unscopables"),pe=Array.prototype;null==pe[de]&&B(pe,de,he(null));function ye(t){pe[de][t]=!0}var ve,ge,me,be={},we=!g(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),_e=T("IE_PROTO"),ke=Object.prototype,je=we?Object.getPrototypeOf:function(t){return t=b(t),z(t,_e)?t[_e]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ke:null},Pe=M("iterator"),Oe=!1;[].keys&&("next"in(me=[].keys())?(ge=je(je(me)))!==Object.prototype&&(ve=ge):Oe=!0),null==ve&&(ve={}),z(ve,Pe)||B(ve,Pe,function(){return this});function Ee(t,e,r){t&&!z(t=r?t:t.prototype,Ie)&&Ce(t,Ie,{configurable:!0,value:e})}function xe(){return this}function Se(){return this}function Ae(t,e,r,n,o,i,a){function s(t){if(t===o&&y)return y;if(!Fe&&t in d)return d[t];switch(t){case"keys":case Le:case Be:return function(){return new r(this,t)}}return function(){return new r(this)}}!function(t,e,r){var n=e+" Iterator";t.prototype=he(De,{next:m(1,r)}),Ee(t,n,!1),be[n]=xe}(r,e,n);var u,c,l,f=e+" Iterator",h=!1,d=t.prototype,p=d[Te]||d["@@iterator"]||o&&d[o],y=!Fe&&p||s(o),v="Array"==e&&d.entries||p;if(v&&(u=je(v.call(new t)),Ne!==Object.prototype&&u.next&&(je(u)!==Ne&&(ze?ze(u,Ne):"function"!=typeof u[Te]&&B(u,Te,Se)),Ee(u,f,!0))),o==Le&&p&&p.name!==Le&&(h=!0,y=function(){return p.call(this)}),d[Te]!==y&&B(d,Te,y),be[e]=y,o)if(c={values:s(Le),keys:i?y:s("keys"),entries:s(Be)},a)for(l in c)!Fe&&!h&&l in d||_t(d,l,c[l]);else mt({target:e,proto:!0,forced:Fe||h},c);return c}var Me={IteratorPrototype:ve,BUGGY_SAFARI_ITERATORS:Oe},Ce=O.f,Ie=M("toStringTag"),De=Me.IteratorPrototype,ze=Object.setPrototypeOf||("__proto__"in{}?function(){var r,n=!1,t={};try{(r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(t,[]),n=t instanceof Array}catch(t){}return function(t,e){return function(t,e){if(d(t),!v(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(t,e),n?r.call(t,e):t.__proto__=e,t}}():void 0),Te=M("iterator"),Ne=Me.IteratorPrototype,Fe=Me.BUGGY_SAFARI_ITERATORS,Le="values",Be="entries",Re="Array Iterator",Ge=wt.set,He=wt.getterFor(Re),Ue=Ae(Array,"Array",function(t,e){Ge(this,{type:Re,target:D(t),index:0,kind:e})},function(){var t=He(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?{value:t.target=void 0,done:!0}:"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values");be.Arguments=be.Array,ye("keys"),ye("values"),ye("entries");var $e=[].join,We=Z!=Object,Ve=Vt("join",",");mt({target:"Array",proto:!0,forced:We||Ve},{join:function(t){return $e.call(D(this),void 0===t?",":t)}});var qe=Wt(1),Je=I("map");mt({target:"Array",proto:!0,forced:!Je},{map:function(t){return qe(this,t,arguments[1])}});var Ke=Math.max,Qe=Math.min,Ye=I("splice");mt({target:"Array",proto:!0,forced:!Ye},{splice:function(t,e){var r,n,o,i,a,s,u=b(this),c=w(u.length),l=dt(t,c),f=arguments.length;if(0===f?r=n=0:n=1===f?(r=0,c-l):(r=f-2,Qe(Ke(h(e),0),c-l)),9007199254740991<c+r-n)throw TypeError("Maximum allowed length exceeded");for(o=C(u,n),i=0;i<n;i++)(a=l+i)in u&&p(o,i,u[a]);if(r<(o.length=n)){for(i=l;i<c-n;i++)s=i+r,(a=i+n)in u?u[s]=u[a]:delete u[s];for(i=c;c-n+r<i;i--)delete u[i-1]}else if(n<r)for(i=c-n;l<i;i--)s=i+r-1,(a=i+n-1)in u?u[s]=u[a]:delete u[s];for(i=0;i<r;i++)u[i+l]=arguments[i+2];return u.length=c-n+r,o}});var Ze=[].slice,Xe={},tr=Function.bind||function(e){var r=Ut(this),n=Ze.call(arguments,1),o=function(){var t=n.concat(Ze.call(arguments));return this instanceof o?function(t,e,r){if(!(e in Xe)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";Xe[e]=Function("C,a","return new C("+n.join(",")+")")}return Xe[e](t,r)}(r,t.length,t):r.apply(e,t)};return v(r.prototype)&&(o.prototype=r.prototype),o};mt({target:"Function",proto:!0},{bind:tr});function er(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ur))?r:cr?o(e):"Object"==(n=o(e))&&"function"==typeof e.callee?"Arguments":n}function rr(e,t,r,n){try{return n?t(d(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&d(o.call(e)),t}}function nr(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}var or=!g(function(){return Object.isExtensible(Object.preventExtensions({}))}),ir=x(function(t){function r(t){e(t,n,{value:{objectID:"O"+ ++o,weakData:{}}})}var n=A("meta"),e=O.f,o=0,i=Object.isExtensible||function(){return!0},a=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!v(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!z(t,n)){if(!i(t))return"F";if(!e)return"E";r(t)}return t[n].objectID},getWeakData:function(t,e){if(!z(t,n)){if(!i(t))return!0;if(!e)return!1;r(t)}return t[n].weakData},onFreeze:function(t){return or&&a.REQUIRED&&i(t)&&!z(t,n)&&r(t),t}};at[n]=!0}),ar=(ir.REQUIRED,ir.fastKey,ir.getWeakData,ir.onFreeze,M("iterator")),sr=Array.prototype,ur=M("toStringTag"),cr="Arguments"==o(function(){return arguments}()),lr=M("iterator"),fr=x(function(t){var f={};(t.exports=function(t,e,r,n,o){var i,a,s,u,c,l=$t(e,r,n?2:1);if(o)i=t;else{if("function"!=typeof(a=function(t){if(null!=t)return t[lr]||t["@@iterator"]||be[er(t)]}(t)))throw TypeError("Target is not iterable");if(function(t){return void 0!==t&&(be.Array===t||sr[ar]===t)}(a)){for(s=0,u=w(t.length);s<u;s++)if((n?l(d(c=t[s])[0],c[1]):l(t[s]))===f)return f;return}i=a.call(t)}for(;!(c=i.next()).done;)if(rr(i,l,c.value,n)===f)return f}).BREAK=f}),hr=M("iterator"),dr=!1;try{var pr=0;({next:function(){return{done:!!pr++}},return:function(){dr=!0}})[hr]=function(){return this}}catch(t){}function yr(t,e,r){for(var n in e)_t(t,n,e[n],r);return t}function vr(t){return"function"==typeof t?t:void 0}function gr(t){var e=function(t,e){return arguments.length<2?vr(mr[t])||vr(_[t]):mr[t]&&mr[t][e]||_[t]&&_[t][e]}(t),r=O.f;f&&e&&!e[br]&&r(e,br,{configurable:!0,get:function(){return this}})}var mr=_,br=M("species"),wr=O.f,_r=ir.fastKey,kr=wt.set,jr=wt.getterFor;!function(n,t,e,o,i){function r(t){var r=s[t];_t(s,t,"add"==t?function(t){return r.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!v(t))&&r.call(this,0===t?0:t)}:"get"==t?function(t){return i&&!v(t)?void 0:r.call(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!v(t))&&r.call(this,0===t?0:t)}:function(t,e){return r.call(this,0===t?0:t,e),this})}var a=_[n],s=a&&a.prototype,u=a,c=o?"set":"add",l={};if(Nt(n,"function"!=typeof a||!(i||s.forEach&&!g(function(){(new a).entries().next()}))))u=e.getConstructor(t,n,o,c),ir.REQUIRED=!0;else if(Nt(n,!0)){var f=new u,h=f[c](i?{}:-0,1)!=f,d=g(function(){f.has(1)}),p=function(t,e){if(!e&&!dr)return!1;var r=!1;try{var n={};n[hr]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r}(function(t){new a(t)}),y=!i&&g(function(){for(var t=new a,e=5;e--;)t[c](e,e);return!t.has(-0)});p||(((u=t(function(t,e){nr(t,u,n);var r=function(t,e,r){var n,o=e.constructor;return o!==r&&"function"==typeof o&&(n=o.prototype)!==r.prototype&&v(n)&&ze&&ze(t,n),t}(new a,t,u);return null!=e&&fr(e,r[c],r,o),r})).prototype=s).constructor=u),(d||y)&&(r("delete"),r("has"),o&&r("get")),(y||h)&&r(c),i&&s.clear&&delete s.clear}l[n]=u,mt({global:!0,forced:u!=a},l),Ee(u,n),i||e.setStrong(u,n,o)}("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{getConstructor:function(t,r,n,o){function i(t,e,r){var n,o,i=s(t),a=u(t,e);return a?a.value=r:(i.last=a={index:o=_r(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=a),n&&(n.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t}var a=t(function(t,e){nr(t,a,r),kr(t,{type:r,index:he(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=e&&fr(e,t[o],t,n)}),s=jr(r),u=function(t,e){var r,n=s(t),o=_r(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return yr(a.prototype,{clear:function(){for(var t=s(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=s(this),r=u(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),f?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=s(this),n=$t(t,1<arguments.length?arguments[1]:void 0,3);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!u(this,t)}}),yr(a.prototype,n?{get:function(t){var e=u(this,t);return e&&e.value},set:function(t,e){return i(this,0===t?0:t,e)}}:{add:function(t){return i(this,t=0===t?0:t,t)}}),f&&wr(a.prototype,"size",{get:function(){return s(this).size}}),a},setStrong:function(t,e,r){var n=e+" Iterator",o=jr(e),i=jr(n);Ae(t,e,function(t,e){kr(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:{value:t.target=void 0,done:!0}},r?"entries":"values",!r,!0),gr(e)}},!0);mt({target:"Object",stat:!0,forced:!f,sham:!f},{defineProperty:O.f});var Pr=et.f,Or=g(function(){Pr(1)});mt({target:"Object",stat:!0,forced:!f||Or,sham:!f},{getOwnPropertyDescriptor:function(t,e){return Pr(D(t),e)}});var Er=g(function(){ie(1)});mt({target:"Object",stat:!0,forced:Er},{keys:function(t){return ie(b(t))}});var xr={};xr[M("toStringTag")]="z";var Sr="[object z]"!==String(xr)?function(){return"[object "+er(this)+"]"}:xr.toString,Ar=Object.prototype;Sr!==Ar.toString&&_t(Ar,"toString",Sr,{unsafe:!0});var Mr="String Iterator",Cr=wt.set,Ir=wt.getterFor(Mr);Ae(String,"String",function(t){Cr(this,{type:Mr,string:String(t),index:0})},function(){var t,e=Ir(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=function(t,e,r){var n,o,i=String(u(t)),a=h(e),s=i.length;return a<0||s<=a?r?"":void 0:(n=i.charCodeAt(a))<55296||56319<n||a+1===s||(o=i.charCodeAt(a+1))<56320||57343<o?r?i.charAt(a):n:r?i.slice(a,a+2):o-56320+(n-55296<<10)+65536}(r,n,!0),e.index+=t.length,{value:t,done:!1})});var Dr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var zr in Dr){var Tr=_[zr],Nr=Tr&&Tr.prototype;if(Nr&&Nr.forEach!==Xt)try{B(Nr,"forEach",Xt)}catch(t){Nr.forEach=Xt}}var Fr=M("iterator"),Lr=M("toStringTag"),Br=Ue.values;for(var Rr in Dr){var Gr=_[Rr],Hr=Gr&&Gr.prototype;if(Hr){if(Hr[Fr]!==Br)try{B(Hr,Fr,Br)}catch(t){Hr[Fr]=Br}if(Hr[Lr]||B(Hr,Lr,Rr),Dr[Rr])for(var Ur in Ue)if(Hr[Ur]!==Ue[Ur])try{B(Hr,Ur,Ue[Ur])}catch(t){Hr[Ur]=Ue[Ur]}}}var $r=x(function(e,r){(function(){var l={once:"boolean",scope:"object"},f=0;function h(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!(t instanceof Function)&&!(t instanceof RegExp)}function d(t,e,r){var n,o,i,a;for(o in t)e.call(r||null,o,t[o]);if(Object.getOwnPropertySymbols)for(i=0,a=(n=Object.getOwnPropertySymbols(t)).length;i<a;i++)e.call(r||null,n[i],t[n[i]])}function t(){this._enabled=!0,this.unbindAll()}function s(t,e){var r,n,o=[];for(n=0,r=(t=t||[]).length;n<r;n++)t[n].fn!==e&&o.push(t[n]);return o}t.prototype.unbindAll=function(){return this._handlers={},this._handlersAll=[],this._handlersComplex=[],this},t.prototype.on=function(t,r,e){var n,o,i,a,s,u,c;if(h(t))return d(t,function(t,e){this.on(t,e,r)},this),this;for("function"==typeof t&&(e=r,r=t,t=null),n=0,o=(s=[].concat(t)).length;n<o;n++){if(a=s[n],c={order:f++,fn:r},"string"==typeof a||"symbol"==typeof a)this._handlers[a]||(this._handlers[a]=[]),u=this._handlers[a],c.type=a;else if(a instanceof RegExp)u=this._handlersComplex,c.pattern=a;else{if(null!==a)throw Error("Emitter.on: invalid event.");u=this._handlersAll}for(i in e||{})l[i]&&(c[i]=e[i]);u.push(c)}return this},t.prototype.once=function(){var t=Array.prototype.slice.call(arguments),e=t.length-1;return h(t[e])&&1<t.length?t[e]=function(t,e){var r,n={};for(r in t)n[r]=t[r];for(r in e)n[r]=e[r];return n}(t[e],{once:!0}):t.push({once:!0}),this.on.apply(this,t)},t.prototype.off=function(t,e){var r,n,o,i;if(1===arguments.length&&"function"==typeof t){for(o in e=t,this._handlers)this._handlers[o]=s(this._handlers[o],e),0===this._handlers[o].length&&delete this._handlers[o];this._handlersAll=s(this._handlersAll,e),this._handlersComplex=s(this._handlersComplex,e)}else if(1!==arguments.length||"string"!=typeof t&&"symbol"!=typeof t)if(2===arguments.length){var a=[].concat(t);for(r=0,n=a.length;r<n;r++)i=a[r],this._handlers[i]=s(this._handlers[i],e),0===(this._handlers[i]||[]).length&&delete this._handlers[i]}else h(t)&&d(t,this.off,this);else delete this._handlers[t];return this},t.prototype.listeners=function(t){var e,r,n,o=this._handlersAll||[],i=!1;if(!t)throw Error("Emitter.listeners: no event provided.");for(o=o.concat(this._handlers[t]||[]),r=0,n=this._handlersComplex.length;r<n;r++)e=this._handlersComplex[r],~t.search(e.pattern)&&(i=!0,o.push(e));return this._handlersAll.length||i?o.sort(function(t,e){return t.order-e.order}):o.slice(0)},t.prototype.emit=function(t,e){if(!this._enabled)return this;if(h(t))return d(t,this.emit,this),this;var r,n,o,i,a,s,u,c,l=[].concat(t),f=[];for(a=0,u=l.length;a<u;a++){for(s=0,c=(o=this.listeners(l[a])).length;s<c;s++)i=o[s],r={type:l[a],target:this},1<arguments.length&&(r.data=e),i.fn.call("scope"in i?i.scope:this,r),i.once&&f.push(i);for(s=f.length-1;0<=s;s--)(n=f[s].type?this._handlers[f[s].type]:f[s].pattern?this._handlersComplex:this._handlersAll).splice(n.indexOf(f[s]),1)}return this},t.prototype.kill=function(){this.unbindAll(),this._handlers=null,this._handlersAll=null,this._handlersComplex=null,this._enabled=!1,this.unbindAll=this.on=this.once=this.off=this.emit=this.listeners=Function.prototype},t.prototype.disable=function(){return this._enabled=!1,this},t.prototype.enable=function(){return this._enabled=!0,this},t.version="3.1.1",e.exports&&(r=e.exports=t),r.Emitter=t}).call(E)}),Wr=($r.Emitter,x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r={};function n(e,t){return t.some(function(t){return r[t](e)})}r.array=function(t){return Array.isArray(t)},r.object=function(t){return t&&"object"===(void 0===t?"undefined":a(t))&&!Array.isArray(t)&&!(t instanceof Date)&&!(t instanceof RegExp)&&!("function"==typeof Map&&t instanceof Map)&&!("function"==typeof Set&&t instanceof Set)},r.string=function(t){return"string"==typeof t},r.number=function(t){return"number"==typeof t},r.function=function(t){return"function"==typeof t},r.primitive=function(t){return t!==Object(t)},r.splicer=function(t){return!(!r.array(t)||t.length<1)&&(!(1<t.length&&isNaN(+t[1]))&&n(t[0],["number","function","object"]))};var o=["string","number","function","object"];r.path=function(t){return!(!t&&0!==t&&""!==t)&&[].concat(t).every(function(t){return n(t,o)})},r.dynamicPath=function(t){return t.some(function(t){return r.function(t)||r.object(t)})},r.monkeyPath=function(t,e){var r,n=[],o=t,i=void 0;for(i=0,r=e.length;i<r;i++){if(n.push(e[i]),"object"!==(void 0===o?"undefined":a(o)))return null;if((o=o[e[i]])instanceof Jr.Monkey)return n}return null},r.lazyGetter=function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return r&&r.get&&!0===r.get.isLazyGetter},r.monkeyDefinition=function(e){if(r.object(e))return r.function(e.get)&&(!e.cursors||r.object(e.cursors)&&Object.keys(e.cursors).every(function(t){return r.path(e.cursors[t])}))?"object":null;if(r.array(e)){var t=1;return r.object(e[e.length-1])&&t++,r.function(e[e.length-t])&&e.slice(0,-t).every(function(t){return r.path(t)})?"array":null}return null},r.watcherMapping=function(e){return r.object(e)&&Object.keys(e).every(function(t){return r.path(e[t])})};var i=["set","apply","push","unshift","concat","pop","shift","deepMerge","merge","splice","unset"];r.operationType=function(t){return"string"==typeof t&&!!~i.indexOf(t)},e.default=r}));t(Wr);var Vr=x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniqid=e.deepMerge=e.shallowMerge=e.deepFreeze=e.freeze=e.deepClone=e.shallowClone=e.Archive=void 0;var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.arrayFrom=function(t){return d(t)},e.before=function(t,e){return function(){t.apply(null,arguments),e.apply(null,arguments)}},e.coercePath=function(t){return t||0===t||""===t?t:[]},e.getIn=function(t,e){if(!e)return m;var r=[],n=!0,o=t,i=void 0,a=void 0,s=void 0;for(a=0,s=e.length;a<s;a++){if(!o)return{data:void 0,solvedPath:r.concat(e.slice(a)),exists:!1};if("function"==typeof e[a]){if(!h.default.array(o))return m;if(!~(i=u(o,e[a])))return m;r.push(i),o=o[i]}else if("object"===f(e[a])){if(!h.default.array(o))return m;if(!~(i=u(o,function(t){return l(t,e[a])})))return m;r.push(i),o=o[i]}else r.push(e[a]),n="object"===(void 0===o?"undefined":f(o))&&e[a]in o,o=o[e[a]]}return{data:o,solvedPath:r,exists:n}},e.makeError=function(t,e){var r=new Error(t);for(var n in e)r[n]=e[n];return r},e.hashPath=function(t){return"Î»"+t.map(function(t){return h.default.function(t)||h.default.object(t)?"#"+j()+"#":t}).join("Î»")},e.solveRelativePath=function(t,e){var r=[];e=[].concat(e);for(var n=0,o=e.length;n<o;n++){var i=e[n];"."===i?n||(r=t.slice(0)):".."===i?r=(n?r:t).slice(0,-1):r.push(i)}return r},e.solveUpdate=function(t,e){var r=void 0,n=void 0,o=void 0,i=void 0,a=void 0,s=void 0,u=void 0,c=void 0;for(r=0,i=t.length;r<i;r++){if(!(u=t[r]).length)return!0;for(n=0,a=e.length;n<a;n++){if(!(c=e[n])||!c.length)return!0;for(o=0,s=c.length;o<s&&c[o]==u[o];o++)if(o+1===s||o+1===u.length)return!0}}return!1},e.splice=function(t,e,r){for(var n=arguments.length,o=Array(3<n?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];if(void 0===r&&2===arguments.length)r=t.length-e;else if(null==r)r=0;else if(isNaN(+r))throw new Error("argument nb "+r+" can not be parsed into a number!");r=Math.max(0,r),h.default.function(e)&&(e=u(t,e));h.default.object(e)&&(e=u(t,function(t){return l(t,e)}));return 0<=e?t.slice(0,e).concat(o).concat(t.slice(e+r)):t.slice(0,t.length+e).concat(o).concat(t.slice(t.length+e+r))};var o,h=(o=Wr)&&o.__esModule?o:{default:o};var a={}.hasOwnProperty;function u(t,e){var r,n=void 0;for(n=0,r=t.length;n<r;n++)if(e(t[n]))return n;return-1}function d(t){var e,r=new Array(t.length),n=void 0;for(n=0,e=t.length;n<e;n++)r[n]=t[n];return r}e.Archive=(r(i,[{key:"get",value:function(){return this.records}},{key:"add",value:function(t){return this.records.unshift(t),this.records.length>this.size&&(this.records.length=this.size),this}},{key:"clear",value:function(){return this.records=[],this}},{key:"back",value:function(t){var e=this.records[t-1];return e&&(this.records=this.records.slice(t)),e}}]),i);function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.size=t,this.records=[]}function p(t,e){if(!e||"object"!==(void 0===e?"undefined":f(e))||e instanceof Error||e instanceof Jr.MonkeyDefinition||e instanceof Jr.Monkey||"ArrayBuffer"in E&&e instanceof ArrayBuffer)return e;if(h.default.array(e)){if(t){for(var r=new Array(e.length),n=0,o=e.length;n<o;n++)r[n]=p(!0,e[n]);return r}return d(e)}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return function(t){var e=t.source,r="";return t.global&&(r+="g"),t.multiline&&(r+="m"),t.ignoreCase&&(r+="i"),t.sticky&&(r+="y"),t.unicode&&(r+="u"),new RegExp(e,r)}(e);if(h.default.object(e)){for(var i={},a=Object.getOwnPropertyNames(e),s=0,u=a.length;s<u;s++){var c=a[s],l=Object.getOwnPropertyDescriptor(e,c);!0===l.enumerable?l.get&&l.get.isLazyGetter?Object.defineProperty(i,c,{get:l.get,enumerable:!0,configurable:!0}):i[c]=t?p(!0,e[c]):e[c]:!1===l.enumerable&&Object.defineProperty(i,c,{value:t?p(!0,l.value):l.value,enumerable:!1,writable:!0,configurable:!0})}return i}return e}var s=p.bind(null,!1),c=p.bind(null,!0);function l(t,e){var r=!0,n=void 0;if(!t)return!1;for(n in e)if(h.default.object(e[n]))r=r&&l(t[n],e[n]);else if(h.default.array(e[n]))r=r&&!!~e[n].indexOf(t[n]);else if(t[n]!==e[n])return!1;return r}function y(t,e){if(!("object"!==(void 0===e?"undefined":f(e))||null===e||e instanceof Jr.Monkey)&&(Object.freeze(e),t))if(Array.isArray(e)){var r,n=void 0;for(n=0,r=e.length;n<r;n++)g(e[n])}else{var o=void 0,i=void 0;for(i in e)h.default.lazyGetter(e,i)||(o=e[i])&&a.call(e,i)&&"object"===(void 0===o?"undefined":f(o))&&!Object.isFrozen(o)&&g(o)}}e.shallowClone=s,e.deepClone=c;var v=y.bind(null,!1),g=y.bind(null,!0);e.freeze=v,e.deepFreeze=g;var m={data:void 0,solvedPath:null,exists:!1};function b(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o,i=r[0],a=void 0,s=void 0,u=void 0;for(s=1,o=r.length;s<o;s++)for(u in a=r[s])!t||!h.default.object(a[u])||a[u]instanceof Jr.Monkey?i[u]=a[u]:i[u]=b(!0,i[u]||{},a[u]);return i}var w=b.bind(null,!1),_=b.bind(null,!0);e.shallowMerge=w,e.deepMerge=_;var k,j=(k=0,function(){return k++});e.uniqid=j});t(Vr);Vr.uniqid,Vr.deepMerge,Vr.shallowMerge,Vr.deepFreeze,Vr.freeze,Vr.deepClone,Vr.shallowClone,Vr.Archive,Vr.arrayFrom,Vr.before,Vr.coercePath,Vr.getIn,Vr.makeError,Vr.hashPath,Vr.solveRelativePath,Vr.solveUpdate,Vr.splice;var qr=x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},o=r.type,i=r.value,a=r.options,s=void 0===a?{}:a,u={root:t},c=["root"].concat(function(t){{if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}}(e)),l=[],f=u,h=void 0,d=void 0,p=void 0;for(h=0,d=c.length;h<d;h++){if(p=c[h],0<h&&l.push(p),h===d-1){if("set"===o){if(n.pure&&f[p]===i)return{node:f[p]};v.default.lazyGetter(f,p)?Object.defineProperty(f,p,{value:i,enumerable:!0,configurable:!0}):n.persistent&&!s.mutableLeaf?f[p]=(0,Vr.shallowClone)(i):f[p]=i}else if("monkey"===o)Object.defineProperty(f,p,{get:i,enumerable:!0,configurable:!0});else if("apply"===o){var y=i(f[p]);if(n.pure&&f[p]===y)return{node:f[p]};v.default.lazyGetter(f,p)?Object.defineProperty(f,p,{value:y,enumerable:!0,configurable:!0}):n.persistent?f[p]=(0,Vr.shallowClone)(y):f[p]=y}else if("push"===o){if(!v.default.array(f[p]))throw g("push","array",l);n.persistent?f[p]=f[p].concat([i]):f[p].push(i)}else if("unshift"===o){if(!v.default.array(f[p]))throw g("unshift","array",l);n.persistent?f[p]=[i].concat(f[p]):f[p].unshift(i)}else if("concat"===o){if(!v.default.array(f[p]))throw g("concat","array",l);n.persistent?f[p]=f[p].concat(i):f[p].push.apply(f[p],i)}else if("splice"===o){if(!v.default.array(f[p]))throw g("splice","array",l);n.persistent?f[p]=Vr.splice.apply(null,[f[p]].concat(i)):f[p].splice.apply(f[p],i)}else if("pop"===o){if(!v.default.array(f[p]))throw g("pop","array",l);n.persistent?f[p]=(0,Vr.splice)(f[p],-1,1):f[p].pop()}else if("shift"===o){if(!v.default.array(f[p]))throw g("shift","array",l);n.persistent?f[p]=(0,Vr.splice)(f[p],0,1):f[p].shift()}else if("unset"===o)v.default.object(f)?delete f[p]:v.default.array(f)&&f.splice(p,1);else if("merge"===o){if(!v.default.object(f[p]))throw g("merge","object",l);n.persistent?f[p]=(0,Vr.shallowMerge)({},f[p],i):f[p]=(0,Vr.shallowMerge)(f[p],i)}else if("deepMerge"===o){if(!v.default.object(f[p]))throw g("deepMerge","object",l);n.persistent?f[p]=(0,Vr.deepMerge)({},f[p],i):f[p]=(0,Vr.deepMerge)(f[p],i)}n.immutable&&!s.mutableLeaf&&(0,Vr.deepFreeze)(f);break}v.default.primitive(f[p])?f[p]={}:n.persistent&&(f[p]=(0,Vr.shallowClone)(f[p])),n.immutable&&0<d&&(0,Vr.freeze)(f),f=f[p]}return v.default.lazyGetter(f,p)?{data:u.root}:{data:u.root,node:f[p]}};var r,v=(r=Wr)&&r.__esModule?r:{default:r};function g(t,e,r){return(0,Vr.makeError)('Baobab.update: cannot apply the "'+t+'" on a non '+e+" (path: /"+r.join("/")+").",{path:r})}});t(qr);var Jr=x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Monkey=e.MonkeyDefinition=void 0;var r=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=o(Wr),c=o(qr);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.MonkeyDefinition=function t(e){var r=this;s(this,t);var n=a.default.monkeyDefinition(e);if(!n)throw(0,Vr.makeError)("Baobab.monkey: invalid definition.",{definition:e});if(this.type=n,"object"===this.type)this.getter=e.get,this.projection=e.cursors||{},this.paths=Object.keys(this.projection).map(function(t){return r.projection[t]}),this.options=e.options||{};else{var o=1,i={};a.default.object(e[e.length-1])&&(o++,i=e[e.length-1]),this.getter=e[e.length-o],this.projection=e.slice(0,-o),this.paths=this.projection,this.options=i}this.paths=this.paths.map(function(t){return[].concat(t)}),this.hasDynamicPaths=this.paths.some(a.default.dynamicPath)},e.Monkey=(r(u,[{key:"relatedPaths",value:function(){var o=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=void 0;return e=this.definition.hasDynamicPaths?this.depPaths.map(function(t){return(0,Vr.getIn)(o.tree._data,t).solvedPath}):this.depPaths,t&&this.depPaths.some(function(t){return!!a.default.monkeyPath(o.tree._monkeys,t)})?e.reduce(function(t,e){var r=a.default.monkeyPath(o.tree._monkeys,e);if(!r)return t.concat([e]);var n=(0,Vr.getIn)(o.tree._monkeys,r).data;return t.concat(n.relatedPaths())},[]):e}},{key:"update",value:function(){var e,r,n,o,i,a=this,t=this.tree.project(this.projection),s=(e=this.tree,r=this.definition,n=t,o=null,i=!1,function(){if(!i){o=r.getter.apply(e,"object"===r.type?[n]:n),e.options.immutable&&!1!==r.options.immutable&&(0,Vr.deepFreeze)(o);var t=(0,Vr.hashPath)(a.path);e._affectedPathsIndex[t]=!0,i=!0}return o});if(s.isLazyGetter=!0,this.tree.options.lazyMonkeys)this.tree._data=(0,c.default)(this.tree._data,this.path,{type:"monkey",value:s},this.tree.options).data;else{var u=(0,c.default)(this.tree._data,this.path,{type:"set",value:s(),options:{mutableLeaf:!this.definition.options.immutable}},this.tree.options);"data"in u&&(this.tree._data=u.data)}return this.tree.emit("_monkey",{monkey:this,path:this.path}),this}},{key:"release",value:function(){this.tree.off("write",this.writeListener),this.tree.off("_monkey",this.recursiveListener),this.state.killed=!0,delete this.projection,delete this.depPaths,delete this.tree}}]),u);function u(t,e,r){var o=this;s(this,u),this.tree=t,this.path=e;var n=(this.definition=r).projection,i=Vr.solveRelativePath.bind(null,e.slice(0,-1));"object"===r.type?(this.projection=Object.keys(n).reduce(function(t,e){return t[e]=i(n[e]),t},{}),this.depPaths=Object.keys(this.projection).map(function(t){return o.projection[t]})):(this.projection=n.map(i),this.depPaths=this.projection),this.state={killed:!1},this.writeListener=function(t){var e=t.data.path;o.state.killed||(0,Vr.solveUpdate)([e],o.relatedPaths())&&o.update()},this.recursiveListener=function(t){var e=t.data,r=e.monkey,n=e.path;o.state.killed||o!==r&&(0,Vr.solveUpdate)([n],o.relatedPaths(!1))&&o.update()},this.tree.on("write",this.writeListener),this.tree.on("_monkey",this.recursiveListener),this.update()}});t(Jr);Jr.Monkey,Jr.MonkeyDefinition;var Kr=x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=i($r),s=i(Wr);function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!e)throw(0,Vr.makeError)("Baobab.Cursor."+t+": cannot use "+t+" on an unresolved dynamic path.",{path:e})}var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,o.default),r(c,[{key:"_getComparedPaths",value:function(){var t=this._monkeyPath?(0,Vr.getIn)(this.tree._monkeys,this._monkeyPath).data.relatedPaths():[];return[this.solvedPath].concat(t)}},{key:"isRoot",value:function(){return!this.path.length}},{key:"isLeaf",value:function(){return s.default.primitive(this._get().data)}},{key:"isBranch",value:function(){return!this.isRoot()&&!this.isLeaf()}},{key:"root",value:function(){return this.tree.select()}},{key:"select",value:function(t){return 1<arguments.length&&(t=(0,Vr.arrayFrom)(arguments)),this.tree.select(this.path.concat(t))}},{key:"up",value:function(){return this.isRoot()?null:this.tree.select(this.path.slice(0,-1))}},{key:"down",value:function(){if(a("down",this.solvedPath),!(this._get().data instanceof Array))throw Error("Baobab.Cursor.down: cannot go down on a non-list type.");return this.tree.select(this.solvedPath.concat(0))}},{key:"left",value:function(){a("left",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.left: cannot go left on a non-list type.");return t?this.tree.select(this.solvedPath.slice(0,-1).concat(t-1)):null}},{key:"right",value:function(){a("right",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.right: cannot go right on a non-list type.");return 1+t===this.up()._get().data.length?null:this.tree.select(this.solvedPath.slice(0,-1).concat(1+t))}},{key:"leftmost",value:function(){a("leftmost",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.leftmost: cannot go left on a non-list type.");return this.tree.select(this.solvedPath.slice(0,-1).concat(0))}},{key:"rightmost",value:function(){a("rightmost",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.rightmost: cannot go right on a non-list type.");var e=this.up()._get().data;return this.tree.select(this.solvedPath.slice(0,-1).concat(e.length-1))}},{key:"map",value:function(r,n){a("map",this.solvedPath);var o=this._get().data,i=arguments.length;if(!s.default.array(o))throw Error("baobab.Cursor.map: cannot map a non-list type.");return o.map(function(t,e){return r.call(1<i?n:this,this.select(e),e,o)},this)}},{key:"_get",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(!s.default.path(t))throw(0,Vr.makeError)("Baobab.Cursor.getters: invalid path.",{path:t});return this.solvedPath?(0,Vr.getIn)(this.tree._data,this.solvedPath.concat(t)):{data:void 0,solvedPath:null,exists:!1}}},{key:"exists",value:function(t){return t=(0,Vr.coercePath)(t),1<arguments.length&&(t=(0,Vr.arrayFrom)(arguments)),this._get(t).exists}},{key:"get",value:function(t){t=(0,Vr.coercePath)(t),1<arguments.length&&(t=(0,Vr.arrayFrom)(arguments));var e=this._get(t),r=e.data,n=e.solvedPath;return this.tree.emit("get",{data:r,solvedPath:n,path:this.path.concat(t)}),r}},{key:"clone",value:function(){var t=this.get.apply(this,arguments);return(0,Vr.shallowClone)(t)}},{key:"deepClone",value:function(){var t=this.get.apply(this,arguments);return(0,Vr.deepClone)(t)}},{key:"serialize",value:function(t){if(t=(0,Vr.coercePath)(t),1<arguments.length&&(t=(0,Vr.arrayFrom)(arguments)),!s.default.path(t))throw(0,Vr.makeError)("Baobab.Cursor.getters: invalid path.",{path:t});if(this.solvedPath){var e=this.solvedPath.concat(t),r=(0,Vr.deepClone)((0,Vr.getIn)(this.tree._data,e).data);return function t(e,r){if(s.default.object(r)&&s.default.object(e))for(var n in r)r[n]instanceof Jr.Monkey?delete e[n]:t(e[n],r[n])}(r,(0,Vr.getIn)(this.tree._monkeys,e).data),r}}},{key:"project",value:function(t){if(s.default.object(t)){var e={};for(var r in t)e[r]=this.get(t[r]);return e}if(s.default.array(t)){for(var n=[],o=0,i=t.length;o<i;o++)n.push(this.get(t[o]));return n}throw(0,Vr.makeError)("Baobab.Cursor.project: wrong projection.",{projection:t})}},{key:"startRecording",value:function(t){if((t=t||1/0)<1)throw(0,Vr.makeError)("Baobab.Cursor.startRecording: invalid max records.",{value:t});return this.state.recording=!0,this.archive||(this._lazyBind(),this.archive=new Vr.Archive(t)),this}},{key:"stopRecording",value:function(){return this.state.recording=!1,this}},{key:"undo",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;if(!this.state.recording)throw new Error("Baobab.Cursor.undo: cursor is not recording.");var e=this.archive.back(t);if(!e)throw Error("Baobab.Cursor.undo: cannot find a relevant record.");return this.state.undoing=!0,this.set(e),this}},{key:"hasHistory",value:function(){return!(!this.archive||!this.archive.get().length)}},{key:"getHistory",value:function(){return this.archive?this.archive.get():[]}},{key:"clearHistory",value:function(){return this.archive&&this.archive.clear(),this}},{key:"release",value:function(){this._dynamicPath&&this.tree.off("write",this._writeHandler),this.tree.off("update",this._updateHandler),this.hash&&delete this.tree._cursors[this.hash],delete this.tree,delete this.path,delete this.solvedPath,delete this.archive,this.kill(),this.state.killed=!0}},{key:"toJSON",value:function(){return this.serialize()}},{key:"toString",value:function(){return this._identity}}]),c);function c(t,e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));e=e||[],a._identity="[object Cursor]",a._archive=null,a.tree=t,a.path=e,a.hash=r,a.state={killed:!1,recording:!1,undoing:!1},a._dynamicPath=s.default.dynamicPath(a.path),a._monkeyPath=s.default.monkeyPath(a.tree._monkeys,a.path),a._dynamicPath?a.solvedPath=(0,Vr.getIn)(a.tree._data,a.path).solvedPath:a.solvedPath=a.path,a._writeHandler=function(t){var e=t.data;!a.state.killed&&(0,Vr.solveUpdate)([e.path],a._getComparedPaths())&&(a.solvedPath=(0,Vr.getIn)(a.tree._data,a.path).solvedPath)};var n=!(a._updateHandler=function(t){if(!a.state.killed){var e=t.data,r=e.paths,n=e.previousData,o=function(t){var e=a,r={get previousData(){return(0,Vr.getIn)(t,e.solvedPath).data},get currentData(){return e.get()}};return a.state.recording&&!a.state.undoing&&a.archive.add(r.previousData),a.state.undoing=!1,a.emit("update",r)}.bind(a,n),i=a._getComparedPaths();return(0,Vr.solveUpdate)(r,i)?o():void 0}});return a._lazyBind=function(){if(!n)return n=!0,a._dynamicPath&&a.tree.on("write",a._writeHandler),a.tree.on("update",a._updateHandler)},a._dynamicPath?a._lazyBind():(a.on=(0,Vr.before)(a._lazyBind,a.on.bind(a)),a.once=(0,Vr.before)(a._lazyBind,a.once.bind(a))),a}e.default=u,"function"==typeof Symbol&&void 0!==Symbol.iterator&&(u.prototype[Symbol.iterator]=function(){var t=this._get().data;if(!s.default.array(t))throw Error("baobab.Cursor.@@iterate: cannot iterate a non-list type.");var e=0,r=this,n=t.length;return{next:function(){return e<n?{value:r.select(e++)}:{done:!0}}}});var l={unset:!0,pop:!0,shift:!0};function f(n,o){u.prototype[n]=function(t,e){if(2<arguments.length)throw(0,Vr.makeError)("Baobab.Cursor."+n+": too many arguments.");if(1!==arguments.length||l[n]||(e=t,t=[]),t=(0,Vr.coercePath)(t),!s.default.path(t))throw(0,Vr.makeError)("Baobab.Cursor."+n+": invalid path.",{path:t});if(o&&!o(e))throw(0,Vr.makeError)("Baobab.Cursor."+n+": invalid value.",{path:t,value:e});if(!this.solvedPath)throw(0,Vr.makeError)("Baobab.Cursor."+n+": the dynamic path of the cursor cannot be solved.",{path:this.path});var r=this.solvedPath.concat(t);return this.tree.update(r,{type:n,value:e})}}f("set"),f("unset"),f("apply",s.default.function),f("push"),f("concat",s.default.array),f("unshift"),f("pop"),f("shift"),f("splice",s.default.splicer),f("merge",s.default.object),f("deepMerge",s.default.object)});t(Kr);var Qr=x(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=s($r),i=s(Kr),a=s(Wr);function s(t){return t&&t.__esModule?t:{default:t}}var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,o.default),r(c,[{key:"getWatchedPaths",value:function(){var n=this;return Object.keys(this.mapping).map(function(t){var e=n.mapping[t];return e instanceof i.default?e.solvedPath:n.mapping[t]}).reduce(function(t,e){if(e=[].concat(e),a.default.dynamicPath(e)&&(e=(0,Vr.getIn)(n.tree._data,e).solvedPath),!e)return t;var r=a.default.monkeyPath(n.tree._monkeys,e);return r?t.concat((0,Vr.getIn)(n.tree._monkeys,r).data.relatedPaths()):t.concat([e])},[])}},{key:"getCursors",value:function(){var r=this,n={};return Object.keys(this.mapping).forEach(function(t){var e=r.mapping[t];e instanceof i.default?n[t]=e:n[t]=r.tree.select(e)}),n}},{key:"refresh",value:function(t){if(!a.default.watcherMapping(t))throw(0,Vr.makeError)("Baobab.watch: invalid mapping.",{mapping:t});this.mapping=t;var e={};for(var r in t)e[r]=t[r]instanceof i.default?t[r].path:t[r];this.get=this.tree.project.bind(this.tree,e)}},{key:"release",value:function(){this.tree.off("update",this.handler),this.state.killed=!0,this.kill()}}]),c);function c(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return r.tree=t,r.mapping=null,r.state={killed:!1},r.refresh(e),r.handler=function(t){if(!r.state.killed){var e=r.getWatchedPaths();return(0,Vr.solveUpdate)(t.data.paths,e)?r.emit("update"):void 0}},r.tree.on("update",r.handler),r}e.default=u});t(Qr);function Yr(t,e){e=e||{};var r=typeof t;if("string"==r&&0<t.length)return function(t){if(100<(t=String(t)).length)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"days":case"day":case"d":return r*tn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Xr;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(t);if("number"==r&&!1===isNaN(t))return e.long?function(t){return en(t,tn,"day")||en(t,Xr,"hour")||en(t,6e4,"minute")||en(t,1e3,"second")||t+" ms"}(t):function(t){if(tn<=t)return Math.round(t/tn)+"d";if(Xr<=t)return Math.round(t/Xr)+"h";if(6e4<=t)return Math.round(t/6e4)+"m";if(1e3<=t)return Math.round(t/1e3)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}var Zr=t(x(function(t){var e=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=s($r),o=s(Kr),i=s(Qr),y=s(Wr),v=s(qr),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}}(Vr);function s(t){return t&&t.__esModule?t:{default:t}}var u=a.arrayFrom,g=a.coercePath,c=a.deepFreeze,m=a.getIn,b=a.makeError,w=a.deepClone,_=a.deepMerge,k=a.shallowClone,j=a.shallowMerge,P=a.hashPath,l={autoCommit:!0,asynchronous:!0,immutable:!0,lazyMonkeys:!0,monkeyBusiness:!0,persistent:!0,pure:!0,validate:null,validationBehavior:"rollback"},f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,r.default),e(h,[{key:"_refreshMonkeys",value:function(t,e,r){function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t instanceof Jr.MonkeyDefinition||t instanceof Jr.Monkey){var r=new Jr.Monkey(i,e,t instanceof Jr.Monkey?t.definition:t);(0,v.default)(i._monkeys,e,{type:"set",value:r},{immutable:!1,persistent:!1,pure:!1})}else if(y.default.object(t))for(var n in t)o(t[n],e.concat(n))}var i=this;if(arguments.length){var n=m(this._monkeys,e).data;n&&!function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(e instanceof Jr.Monkey)return e.release(),void(0,v.default)(i._monkeys,r,{type:"unset"},{immutable:!1,persistent:!1,pure:!1});if(y.default.object(e))for(var n in e)t(e[n],r.concat(n))}(n,e),"unset"!==r&&o(t,e)}else o(this._data);return this}},{key:"validate",value:function(t){var e=this.options,r=e.validate,n=e.validationBehavior;if("function"!=typeof r)return null;var o=r.call(this,this._previousData,this._data,t||[[]]);return o instanceof Error?("rollback"===n&&(this._data=this._previousData,this._affectedPathsIndex={},this._transaction=[],this._previousData=this._data),this.emit("invalid",{error:o}),o):null}},{key:"select",value:function(t){if(t=t||[],1<arguments.length&&(t=u(arguments)),!y.default.path(t))throw b("Baobab.select: invalid path.",{path:t});t=[].concat(t);var e=P(t),r=this._cursors[e];return r||(r=new o.default(this,t,e),this._cursors[e]=r),this.emit("select",{path:t,cursor:r}),r}},{key:"update",value:function(t,e){var r=this;if(t=g(t),!y.default.operationType(e.type))throw b('Baobab.update: unknown operation type "'+e.type+'".',{operation:e});var n=m(this._data,t),o=n.solvedPath,i=n.exists;if(!o)throw b("Baobab.update: could not solve the given path.",{path:o});var a=y.default.monkeyPath(this._monkeys,o);if(a&&o.length>a.length)throw b("Baobab.update: attempting to update a read-only path.",{path:o});if("unset"!==e.type||i){var s=e;if(/merge/i.test(e.type)){var u=m(this._monkeys,o).data;if(y.default.object(u)){s=k(s);var c=m(this._data,o).data;/deep/i.test(s.type)?s.value=_({},_({},c,w(u)),s.value):s.value=j({},_({},c,w(u)),s.value)}}this._transaction.length||(this._previousData=this._data);var l=(0,v.default)(this._data,o,s,this.options),f=l.data,h=l.node;if(!("data"in l))return h;var d=o.concat("push"===e.type?h.length-1:[]),p=P(d);return this._data=f,this._affectedPathsIndex[p]=!0,this._transaction.push(j({},e,{path:d})),this.options.monkeyBusiness&&this._refreshMonkeys(h,o,e.type),this.emit("write",{path:d}),this.options.autoCommit&&(this.options.asynchronous?this._future||(this._future=setTimeout(function(){return r.commit()},0)):this.commit()),h}}},{key:"commit",value:function(){if(!this._transaction.length)return this;this._future&&(this._future=clearTimeout(this._future));var t=Object.keys(this._affectedPathsIndex).map(function(t){return"Î»"!==t?t.split("Î»").slice(1):[]});if(this.validate(t))return this;var e=this._transaction,r=this._previousData;return this._affectedPathsIndex={},this._transaction=[],this._previousData=this._data,this.emit("update",{paths:t,currentData:this._data,transaction:e,previousData:r}),this}},{key:"getMonkey",value:function(t){t=g(t);var e=m(this._monkeys,[].concat(t)).data;return e instanceof Jr.Monkey?e:null}},{key:"watch",value:function(t){return new i.default(this,t)}},{key:"release",value:function(){var t=void 0;for(t in this.emit("release"),delete this.root,delete this._data,delete this._previousData,delete this._transaction,delete this._affectedPathsIndex,delete this._monkeys,this._cursors)this._cursors[t].release();delete this._cursors,this.kill()}},{key:"toJSON",value:function(){return this.serialize()}},{key:"toString",value:function(){return this._identity}}]),h);function h(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));if(arguments.length<1&&(t={}),!y.default.object(t)&&!y.default.array(t))throw b("Baobab: invalid data.",{data:t});r.options=j({},l,e),r.options.persistent||(r.options.immutable=!1,r.options.pure=!1),r._identity="[object Baobab]",r._cursors={},r._future=null,r._transaction=[],r._affectedPathsIndex={},r._monkeys={},r._previousData=null,r._data=t,r.root=new o.default(r,[],"Î»"),delete r.root.release,r.options.immutable&&c(r._data);["apply","clone","concat","deepClone","deepMerge","exists","get","push","merge","pop","project","serialize","set","shift","splice","unset","unshift"].forEach(function(e){r[e]=function(){var t=this.root[e].apply(this.root,arguments);return t instanceof o.default?this:t}}),r.options.monkeyBusiness&&r._refreshMonkeys();var n=r.validate();if(n)throw Error("Baobab: invalid data.",{error:n});return r}f.monkey=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(!e.length)throw new Error("Baobab.monkey: missing definition.");return 1===e.length&&"function"!=typeof e[0]?new Jr.MonkeyDefinition(e[0]):new Jr.MonkeyDefinition(e)},f.dynamicNode=f.monkey,f.Cursor=o.default,f.MonkeyDefinition=Jr.MonkeyDefinition,f.Monkey=Jr.Monkey,f.type=y.default,f.helpers=a,f.VERSION="2.5.2",t.exports=f})),Xr=36e5,tn=864e5;function en(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var rn=x(function(t,s){var u;function e(t){function n(){if(n.enabled){var o=n,t=+new Date,e=t-(u||t);o.diff=e,o.prev=u,o.curr=t,u=t;for(var i=new Array(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];i[0]=s.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(t,e){if("%%"===t)return t;a++;var r=s.formatters[e];if("function"==typeof r){var n=i[a];t=r.call(o,n),i.splice(a,1),a--}return t}),s.formatArgs.call(o,i),(n.log||s.log||console.log.bind(console)).apply(o,i)}}return n.namespace=t,n.enabled=s.enabled(t),n.useColors=s.useColors(),n.color=function(t){var e,r=0;for(e in t)r=(r<<5)-r+t.charCodeAt(e),r|=0;return s.colors[Math.abs(r)%s.colors.length]}(t),"function"==typeof s.init&&s.init(n),n}(s=t.exports=e.debug=e.default=e).coerce=function(t){return t instanceof Error?t.stack||t.message:t},s.disable=function(){s.enable("")},s.enable=function(t){s.save(t),s.names=[],s.skips=[];for(var e=("string"==typeof t?t:"").split(/[\s,]+/),r=e.length,n=0;n<r;n++)e[n]&&("-"===(t=e[n].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+t.substr(1)+"$")):s.names.push(new RegExp("^"+t+"$")))},s.enabled=function(t){var e,r;for(e=0,r=s.skips.length;e<r;e++)if(s.skips[e].test(t))return!1;for(e=0,r=s.names.length;e<r;e++)if(s.names[e].test(t))return!0;return!1},s.humanize=Yr,s.names=[],s.skips=[],s.formatters={}}),nn=(rn.coerce,rn.disable,rn.enable,rn.enabled,rn.humanize,rn.names,rn.skips,rn.formatters,x(function(t,i){function e(){var t;try{t=i.storage.debug}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t}(i=t.exports=rn).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),!e)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(n++,"%c"===t&&(o=n))}),t.splice(o,0,r)},i.save=function(t){try{null==t?i.storage.removeItem("debug"):i.storage.debug=t}catch(t){}},i.load=e,i.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},i.enable(e())})),on=(nn.log,nn.formatArgs,nn.save,nn.load,nn.useColors,nn.storage,nn.colors,nn("Dispatchr:Action"));function an(t,e){this.name=t,this.payload=e,this._handlers=null,this._isExecuting=!1,this._isCompleted=null}an.prototype.getStoreName=function(t){return"string"==typeof t?t:t.storeName},an.prototype.execute=function(t){if(this._isExecuting)throw new Error("Action is already dispatched");var e=this;this._handlers=t,this._isExecuting=!0,this._isCompleted={},Object.keys(t).forEach(function(t){e._callHandler(t)})},an.prototype._callHandler=function(t){var e=this,r=e._handlers[t];if(!r)throw new Error(t+" does not have a handler for action "+e.name);e._isCompleted[t]||(e._isCompleted[t]=!1,on("executing handler for "+t),r(e.payload,e.name),e._isCompleted[t]=!0)},an.prototype.waitFor=function(t,e){var r=this;if(!r._isExecuting)throw new Error("waitFor called even though there is no action being executed!");Array.isArray(t)||(t=[t]),on("waiting on "+t.join(", ")),t.forEach(function(t){t=r.getStoreName(t),r._handlers[t]&&r._callHandler(t)}),e()};var sn=an,un=nn("Dispatchr:DispatcherContext");function cn(t,e){this.dispatcher=t,this.storeInstances={},this.currentAction=null,this.dispatcherInterface={getContext:function(){return e},getStore:this.getStore.bind(this),waitFor:this.waitFor.bind(this)}}cn.prototype.getStore=function(t){var e=this.dispatcher.getStoreName(t);if(!this.storeInstances[e]){if(!this.dispatcher.stores[e])throw new Error("Store "+e+" was not registered.");this.storeInstances[e]=new this.dispatcher.stores[e](this.dispatcherInterface)}return this.storeInstances[e]},cn.prototype.dispatch=function(t,e){if(!t)throw new Error("actionName parameter `"+t+"` is invalid.");if(this.currentAction)throw new Error("Cannot call dispatch while another dispatch is executing. Attempted to execute '"+t+"' but '"+this.currentAction.name+"' is already executing.");var r=this.dispatcher.handlers[t]||[],n=this.dispatcher.handlers.default||[];if(r.length||n.length){un("dispatching "+t,e),this.currentAction=new sn(t,e);var o=this,i=r.concat(n),a={};try{i.forEach(function(t){if(!a[t.name]){var e=o.getStore(t.name);if("function"==typeof t.handler)a[t.name]=t.handler.bind(e);else{if(!e[t.handler])throw new Error(t.name+" does not have a method called "+t.handler);a[t.name]=e[t.handler].bind(e)}}}),this.currentAction.execute(a)}catch(t){throw t}finally{un("finished "+t),this.currentAction=null}}else un(t+" does not have any registered handlers")},cn.prototype.dehydrate=function(){var r=this,n={};return Object.keys(r.storeInstances).forEach(function(t){var e=r.storeInstances[t];!e.dehydrate||e.shouldDehydrate&&!e.shouldDehydrate()||(n[t]=e.dehydrate())}),{stores:n}},cn.prototype.rehydrate=function(n){var o=this;n.stores&&Object.keys(n.stores).forEach(function(t){var e=n.stores[t],r=o.getStore(t);r.rehydrate&&r.rehydrate(e)})},cn.prototype.waitFor=function(t,e){if(!this.currentAction)throw new Error("waitFor called even though there is no action dispatching");this.currentAction.waitFor(t,e)};var ln=cn;function fn(t){(t=t||{}).stores=t.stores||[],this.stores={},this.handlers={},this.handlers.default=[],this.hasWarnedAboutNameProperty=!1,t.stores.forEach(function(t){this.registerStore(t)},this)}fn.prototype.createContext=function(t){return new ln(this,t)},fn.prototype.registerStore=function(r){if("function"!=typeof r)throw new Error("registerStore requires a constructor as first parameter");var n=this.getStoreName(r);if(!n)throw new Error("Store is required to have a `storeName` property.");if(this.stores[n]){if(this.stores[n]===r)return;throw new Error("Store with name `"+n+"` has already been registered.")}(this.stores[n]=r).handlers&&Object.keys(r.handlers).forEach(function(t){var e=r.handlers[t];this._registerHandler(t,n,e)},this)},fn.prototype.isRegistered=function(t){var e=this.getStoreName(t),r=this.stores[e];return!!r&&("function"!=typeof t||t===r)},fn.prototype.getStoreName=function(t){return"string"==typeof t?t:t.storeName?t.storeName:("production"!==process.env.NODE_ENV&&t.name&&!this.hasWarnedAboutNameProperty&&(console.warn("A store has been registered that relies on the constructor's name property. This name may change when you minify your stores during build time and could break string references to your store. It is advised that you add a static `storeName` property to your store to ensure the store name does not change during your build."),this.hasWarnedAboutNameProperty=!0),t.name)},fn.prototype._registerHandler=function(t,e,r){return this.handlers[t]=this.handlers[t]||[],this.handlers[t].push({name:this.getStoreName(e),handler:r}),this.handlers.length-1};var hn={createDispatcher:function(t){return new fn(t)}},dn=a.module,pn=[],yn=!1,vn=!0;(new Map).set(a,!0);function gn(e){this.stores=[],this.dispatcherInstance=hn.createDispatcher(),this.dispatcher=this.dispatcherInstance.createContext(),this.dispatch=function(){pn.length&&console.warn("There are still stores not injected: "+pn.join(",")+". Make sure to manually inject all stores before running any dispatches or set autoInjectStores to true."),this.dispatcher.dispatch.apply(this.dispatcher,arguments)},this.createStore=function(t,r){var n,o=function(e,r,n,o){function i(t){if(this.dispatcher=t,this.waitFor=function(t,e){if(t=Array.isArray(t)?t:[t],!o.areStoresRegistered(t))throw new Error("Waiting for stores that are not injected into Angular yet, "+t.join(", ")+". Be sure to inject stores before waiting for them");this.dispatcher.waitFor(t,e.bind(this))},!this.initialize)throw new Error("Store "+e+" does not have an initialize method which is is necessary to set the initial state");this.initialize()}return void 0===r&&(r={}),i.handlers=r.handlers,i.storeName=e,i.prototype.immutable=function(t,e){return void 0===e&&(e={}),this.__tree?this.__tree.set(t):this.__tree=new Zr(t,a.extend({},n,e)),this.__tree},i.prototype.monkey=Zr.monkey,Object.keys(r).forEach(function(t){i.prototype[t]=r[t]}),i}(t,r,e,this);if(o.exports={},this.dispatcherInstance.registerStore(o),this.stores.push(o),!r.exports)throw new Error("You have to add an exports object to your store: "+t);return n=this.dispatcher.getStore(o),Object.keys(r.exports).forEach(function(t){var e=Object.getOwnPropertyDescriptor(r.exports,t);e.get?Object.defineProperty(o.exports,t,{enumerable:e.enumerable,configurable:e.configurable,get:function(){return e.get.apply(n)}}):(o.exports[t]=function(){return r.exports[t].apply(n,arguments)},r.exports[t]=r.exports[t].bind(n))}),o.exports},this.getStore=function(e){var t=this.stores.filter(function(t){return t.exports===e})[0];return this.dispatcher.getStore(t)},this.areStoresRegistered=function(t){var e=this.stores.map(function(t){return t.storeName});return t.every(function(t){return-1<e.indexOf(t)})},this.reset=function(){this.dispatcherInstance.stores={},this.dispatcherInstance.handlers={},this.stores=[],pn=[]},this.Baobab=Zr}a.module=function(){var t=dn.apply(a,arguments);return t.store=function(n,o){return pn.push(n),this.factory(n,["$injector","flux",function(t,e){var r=t.invoke(o);return pn.splice(pn.indexOf(n),1),e.createStore(n,r)}]),this},t},a.module("flux",[]).provider("flux",function(){var e={};this.setImmutableDefaults=function(t){e=t},this.autoInjectStores=function(t){yn=t},this.useEvalAsync=function(t){vn=t},this.$get=[function(){return new gn(e)}]}).run(["$rootScope","$injector","flux",function(t,e,s){a.mock&&(vn=!1,s.reset()),!a.mock&&yn&&e.invoke(pn.concat(a.noop)),t.constructor.prototype.$listenTo=function(t,e,r){var n,o,i=this,a=s.getStore(t);if(!a.__tree)throw new Error("Store "+t.storeName+" has not defined state with this.immutable() which is required in order to use $listenTo");n=r?a.__tree.select(e):(r=e,a.__tree),o=r,vn&&(r=function(t){i.$evalAsync(function(){return o(t)})}),n.on("update",r),o({}),this.$on("$destroy",function(){return n.off("update",r)})}}]),module.exports="flux"});
//# sourceMappingURL=flux-angular.umd.js.map
